group_by(metric,treatment, timepoint) %>%
summarize(N=n(),avg=round(mean(value),3)) %>%
spread(key = metric, value = avg)
metadata <- fread("/home/mycelium/milkqua_project/Rumen/mapping_file_rumen.csv")
names(metadata)[1] <- "sample"
names(metadata)[2] <- "treatment"
names(metadata)[4] <- "timepoint"
alpha <- read.table("/home/mycelium/milkqua_project/Rumen/results/alpha_diversity/alpha.txt", header = TRUE)
alpha$sample <- row.names(alpha)
alpha$observed_species <- NULL
mAlpha <- reshape2::melt(alpha, id.vars = "sample", variable.name = "metric", value.name = "value")
mAlpha$type <- metadata$sample_type[match(mAlpha$sample,metadata$sample)]
mAlpha$timepoint <- metadata$timepoint[match(mAlpha$sample,metadata$sample)]
mAlpha$treatment <- metadata$treatment[match(mAlpha$sample,metadata$sample)]
mAlpha$timepoint <- factor(mAlpha$timepoint, levels = c("0","AE1","AE sintético 1","Carvacrol", "p-cymene", "γ-terpinene"))
D <- mAlpha %>%
group_by(metric,treatment, timepoint) %>%
summarize(N=n(),avg=round(mean(value),3)) %>%
spread(key = metric, value = avg)
D$timepoint <- factor(D$timepoint, levels = c("0","AE1","AE sintético 1","Carvacrol", "p-cymene", "γ-terpinene"))
d_alpha <- D %>%
gather(key = "metric", value = "value", -c(treatment,timepoint,N)) %>%
spread(key = "treatment", value = "value")
kable(D)
metadata <- fread("/home/mycelium/milkqua_project/Rumen/mapping_file_rumen.csv")
names(metadata)[1] <- "sample"
names(metadata)[2] <- "treatment"
names(metadata)[4] <- "timepoint"
alpha <- read.table("/home/mycelium/milkqua_project/Rumen/results/alpha_diversity/alpha.txt", header = TRUE)
alpha$sample <- row.names(alpha)
alpha$observed_species <- NULL
mAlpha <- reshape2::melt(alpha, id.vars = "sample", variable.name = "metric", value.name = "value")
mAlpha$type <- metadata$sample_type[match(mAlpha$sample,metadata$sample)]
mAlpha$timepoint <- metadata$timepoint[match(mAlpha$sample,metadata$sample)]
mAlpha$treatment <- metadata$treatment[match(mAlpha$sample,metadata$sample)]
mAlpha <- filter(mAlpha, type == "milk") %>% select(-c(type))
metadata <- fread("/home/mycelium/milkqua_project/Rumen/mapping_file_rumen.csv")
names(metadata)[1] <- "sample"
names(metadata)[2] <- "treatment"
names(metadata)[4] <- "timepoint"
alpha <- read.table("/home/mycelium/milkqua_project/Rumen/results/alpha_diversity/alpha.txt", header = TRUE)
alpha$sample <- row.names(alpha)
alpha$observed_species <- NULL
mAlpha <- reshape2::melt(alpha, id.vars = "sample", variable.name = "metric", value.name = "value")
mAlpha$type <- metadata$sample_type[match(mAlpha$sample,metadata$sample)]
mAlpha$timepoint <- metadata$timepoint[match(mAlpha$sample,metadata$sample)]
mAlpha$treatment <- metadata$treatment[match(mAlpha$sample,metadata$sample)]
mAlpha$timepoint <- factor(mAlpha$timepoint, levels = c("0","AE1","AE sintético 1","Carvacrol", "p-cymene", "γ-terpinene"))
D <- mAlpha %>%
group_by(metric,treatment, timepoint) %>%
summarize(N=n(),avg=round(mean(value),3)) %>%
spread(key = metric, value = avg)
D$timepoint <- factor(D$timepoint, levels = c("0","AE1","AE sintético 1","Carvacrol", "p-cymene", "γ-terpinene"))
d_alpha <- D %>%
gather(key = "metric", value = "value", -c(treatment,timepoint,N)) %>%
spread(key = "treatment", value = "value")
kable(D)
knitr::opts_chunk$set(echo = TRUE)
library("DT")
library("knitr")
library("dplyr")
library("tidyr")
library("broom")
library("vegan")
library("scales")
library("ggplot2")
library("ggpubr")
# library("madbito")
library("reshape2")
library("gghighlight")
library("data.table")
metadata <- fread("/home/mycelium/milkqua_project/Rumen/mapping_file_rumen.csv")
names(metadata)[1] <- "sample"
names(metadata)[2] <- "treatment"
names(metadata)[4] <- "timepoint"
alpha <- read.table("/home/mycelium/milkqua_project/Rumen/results/alpha_diversity/alpha.txt", header = TRUE)
alpha$sample <- row.names(alpha)
alpha$observed_species <- NULL
mAlpha <- reshape2::melt(alpha, id.vars = "sample", variable.name = "metric", value.name = "value")
mAlpha$type <- metadata$sample_type[match(mAlpha$sample,metadata$sample)]
mAlpha$timepoint <- metadata$timepoint[match(mAlpha$sample,metadata$sample)]
mAlpha$treatment <- metadata$treatment[match(mAlpha$sample,metadata$sample)]
View(mAlpha)
View(metadata)
mAlpha$treatment <- factor(mAlpha$treatment, levels = c("0","AE1","AE sintético 1","Carvacrol", "p-cymene", "γ-terpinene"))
View(mAlpha)
View(alpha)
metadata[8] <- mutate(metadata[1]=metadata[8])
metadata[8] <- mutate(metadata[1] = metadata[8])
metadata <- metadata %>%
mutate(sample=sample)
metadata <- fread("/home/mycelium/milkqua_project/Rumen/mapping_file_rumen.csv")
names(metadata)[1] <- "sample"
metadata <- metadata %>%
mutate(sample=sample)
names(metadata)[2] <- "treatment"
names(metadata)[4] <- "timepoint"
View(metadata)
metadata <- fread("/home/mycelium/milkqua_project/Rumen/mapping_file_rumen.csv")
names(metadata)[1] <- "sample"
#metadata <- metadata %>%
mutate(sample=sample)
knitr::opts_chunk$set(echo = TRUE)
library("DT")
library("knitr")
library("dplyr")
library("tidyr")
library("broom")
library("vegan")
library("scales")
library("ggplot2")
library("ggpubr")
# library("madbito")
library("reshape2")
library("gghighlight")
library("data.table")
metadata <- fread("/home/mycelium/milkqua_project/Rumen/mapping_file_rumen.csv")
names(metadata)[1] <- "sample"
#metadata <- metadata %>%
mutate(sample=sample)
#metadata <- metadata %>%
#  mutate(sample=sample)
names(metadata)[2] <- "treatment"
names(metadata)[4] <- "timepoint"
View(metadata)
metadata <- fread("/home/mycelium/milkqua_project/Rumen/mapping_file_rumen.csv")
names(metadata)[1] <- "sample"
metadata <- metadata %>%
mutate(sample2=sample)
names(metadata)[2] <- "treatment"
names(metadata)[4] <- "timepoint"
metadata <- fread("/home/mycelium/milkqua_project/Rumen/mapping_file_rumen.csv")
names(metadata)[1] <- "sample"
metadata <- metadata %>%
mutate(sample2=sample)
library(tidyr)
metadata %>%
unite("Sample", sample:sample2, remove = FALSE)
names(metadata)[2] <- "treatment"
names(metadata)[4] <- "timepoint"
View(metadata)
metadata <- fread("/home/mycelium/milkqua_project/Rumen/mapping_file_rumen.csv")
names(metadata)[1] <- "sample"
metadata <- metadata %>%
mutate(sample2=sample)
library(tidyr)
metadata %>%
unite('Merged', sample:sample2, remove = FALSE)
names(metadata)[2] <- "treatment"
names(metadata)[4] <- "timepoint"
View(metadata)
metadata <- fread("/home/mycelium/milkqua_project/Rumen/mapping_file_rumen.csv")
names(metadata)[1] <- "sample"
metadata <- metadata %>%
mutate(sample2=sample)
library(tidyr)
metadata <- metadata %>%
unite('Merged', sample:sample2, remove = FALSE)
names(metadata)[2] <- "treatment"
names(metadata)[4] <- "timepoint"
View(metadata)
metadata <- fread("/home/mycelium/milkqua_project/Rumen/mapping_file_rumen.csv")
names(metadata)[1] <- "sample"
metadata <- metadata %>%
mutate(sample2=sample)
library(tidyr)
metadata <- metadata %>%
unite('Merged', sample-sample2, remove = FALSE)
```{r alpha, echo=FALSE}
metadata <- fread("/home/mycelium/milkqua_project/Rumen/mapping_file_rumen.csv")
names(metadata)[1] <- "sample"
metadata <- metadata %>%
mutate(sample2=sample)
library(tidyr)
metadata <- metadata %>%
unite('Merged', sample:sample2, remove = TRUE)
names(metadata)[2] <- "treatment"
names(metadata)[4] <- "timepoint"
metadata <- metadata %>%
unite('Merged', sample:sample2, remove = FALSE)
View(metadata)
metadata <- fread("/home/mycelium/milkqua_project/Rumen/mapping_file_rumen.csv")
names(metadata)[1] <- "sample"
metadata <- metadata %>%
mutate(sample2=sample)
View(metadata)
library(tidyr)
metadata <- metadata %>%
unite('Merged', sample:sample2, remove = FALSE)
metadata <- metadata %>%
unite('Merged', sample+sample2, remove = FALSE)
metadata <- fread("/home/mycelium/milkqua_project/Rumen/mapping_file_rumen.csv")
names(metadata)[1] <- "sample"
metadata <- metadata %>%
mutate(sample2=sample)
library(tidyr)
metadata <- metadata %>%
unite('Merged', sample&sample2, remove = FALSE)
metadata <- fread("/home/mycelium/milkqua_project/Rumen/mapping_file_rumen.csv")
names(metadata)[1] <- "sample"
metadata <- metadata %>%
mutate(sample2=sample)
library(tidyr)
metadata <- metadata %>%
unite('Merged', sample:sample2, remove = TRUE)
library(tidyr)
metadata <- metadata %>%
unite('Merged', sample:sample2, remove = FALSE)
metadata <- fread("/home/mycelium/milkqua_project/Rumen/mapping_file_rumen.csv")
names(metadata)[1] <- "sample"
metadata <- metadata %>%
mutate(sample2=sample)
library(tidyr)
metadata <- metadata %>%
unite('Merged', sample:sample2, remove = FALSE)
subset <- metadata[1]
metadata <- fread("/home/mycelium/milkqua_project/Rumen/mapping_file_rumen.csv")
names(metadata)[1] <- "sample"
subset <- metadata[1]
subset <- subset%Y%
mutate(sample2=sample)
subset <- subset %>%
mutate(sample2=sample)
library(tidyr)
subset <- subset %>%
unite('Merged', sample:sample2, remove = FALSE)
View(subset)
metadata <- fread("/home/mycelium/milkqua_project/Rumen/mapping_file_rumen.csv")
names(metadata)[1] <- "sample"
subset <- metadata[1]
View(subset)
subset <- metadata[1]
subset <- metadata.column[1]
metadata <- fread("/home/mycelium/milkqua_project/Rumen/mapping_file_rumen.csv")
names(metadata)[1] <- "sample"
subset <- (metadata)[1]
View(subset)
metadata <- fread("/home/mycelium/milkqua_project/Rumen/mapping_file_rumen.csv")
names(metadata)[1] <- "sample"
names(metadata)[2] <- "treatment"
names(metadata)[4] <- "timepoint"
alpha <- read.table("/home/mycelium/milkqua_project/Rumen/results/alpha_diversity/alpha.txt", header = TRUE)
alpha$sample <- row.names(alpha)
alpha$observed_species <- NULL
mAlpha <- reshape2::melt(alpha, id.vars = "sample", variable.name = "metric", value.name = "value")
mAlpha$type <- metadata$sample_type[match(mAlpha$sample,metadata$sample)]
mAlpha$timepoint <- metadata$timepoint[match(mAlpha$sample,metadata$sample)]
mAlpha$treatment <- metadata$treatment[match(mAlpha$sample,metadata$sample)]
mAlpha$type <- metadata$sample_type[match(mAlpha$sample,metadata$sample)]
mAlpha$timepoint <- metadata$timepoint[match(mAlpha$sample,metadata$sample)]
mAlpha$treatment <- metadata$treatment[match(mAlpha$sample,metadata$sample)]
## Averages and plots
```{r, echo=FALSE}
mAlpha$timepoint <- factor(mAlpha$timepoint, levels = c("0","AE1","AE sintético 1","Carvacrol", "p-cymene", "γ-terpinene"))
D <- mAlpha %>%
group_by(metric,treatment, timepoint) %>%
summarize(N=n(),avg=round(mean(value),3)) %>%
spread(key = metric, value = avg)
D$timepoint <- factor(D$timepoint, levels = c("0","AE1","AE sintético 1","Carvacrol", "p-cymene", "γ-terpinene"))
d_alpha <- D %>%
gather(key = "metric", value = "value", -c(treatment,timepoint,N)) %>%
spread(key = "treatment", value = "value")
kable(D)
metadata <- fread("/home/mycelium/milkqua_project/Rumen/mapping_file_rumen.csv")
names(metadata)[1] <- "sample"
names(metadata)[2] <- "treatment"
names(metadata)[4] <- "timepoint"
metadata <- fread("/home/mycelium/milkqua_project/Rumen/mapping_file_rumen.csv")
names(metadata)[1] <- "sample"
# subset <- metadata[1]
# subset <- subset %>%
#   mutate(sample2=sample)
# library(tidyr)
# subset <- subset %>%
#   unite('Merged', sample:sample2, remove = FALSE)
#
names(metadata)[2] <- "treatment"
names(metadata)[4] <- "timepoint"
alpha <- read.table("/home/mycelium/milkqua_project/Rumen/results/alpha_diversity/alpha.txt", header = TRUE)
alpha$sample <- row.names(alpha)
alpha$observed_species <- NULL
mAlpha <- reshape2::melt(alpha, id.vars = "sample", variable.name = "metric", value.name = "value")
mAlpha$type <- metadata$sample_type[match(mAlpha$sample,metadata$sample)]
mAlpha$timepoint <- metadata$timepoint[match(mAlpha$sample,metadata$sample)]
mAlpha$treatment <- metadata$treatment[match(mAlpha$sample,metadata$sample)]
View(alpha)
View(mAlpha)
View(metadata)
View(metadata)
View(alpha)
View(mAlpha)
View(alpha)
subset <- metadata(metadata$sample)
subset <- metadata$sample
dsx<-subset.data.frame(sample,metadata)
df <- df[c(subset)]
df[c(subset)]
subset <- data.frame(metadata$sample)
View(subset)
subset <- data.frame(metadata$sample)
subset <- subset %>%
mutate(sample2=sample)
View(subset)
subset <- subset %>%
mutate(metadata.sample2=metadata.sample)
library(tidyr)
subset <- subset %>%
unite('Merged', metadata.sample2=metadata.sample, remove = FALSE)
View(subset)
subset <- subset %>%
unite('Merged', metadata.sample2=metadata.sample, remove = FALSE)
subset <- data.frame(metadata$sample)
subset <- subset %>%
mutate(metadata.sample2=metadata.sample)
library(tidyr)
subset <- subset %>%
unite('Merged', metadata.sample2=metadata.sample, remove = FALSE)
subset <- subset %>%
unite('Merged', 'metadata.sample2'='metadata.sample', remove = FALSE)
subset <- subset %>%
unite('Merged', metadata.sample=metadata.sample, remove = FALSE)
knitr::opts_chunk$set(echo = TRUE)
library("DT")
library("knitr")
library("dplyr")
library("tidyr")
library("broom")
library("vegan")
library("scales")
library("ggplot2")
library("ggpubr")
# library("madbito")
library("reshape2")
library("gghighlight")
library("data.table")
metadata <- fread("/home/mycelium/milkqua_project/Rumen/mapping_file_rumen.csv")
names(metadata)[1] <- "sample"
subset <- data.frame(metadata$sample)
subset <- subset %>%
mutate(metadata.sample2=metadata.sample)
library(tidyr)
subset <- subset %>%
unite('Merged', metadata.sample=metadata.sample, remove = FALSE)
subset <- subset %>%
unite('Merged', metadata.sample2=metadata.sample, remove = FALSE)
library(tidyr)
subset$Concatenated <- paste(subset$metadata.sample, subset$metadata.sample2)
View(subset)
subset$Concatenated <- paste(subset$metadata.sample, subset$metadata.sample2, collapse = TRUE)
subset$Concatenated <- paste(subset$metadata.sample, subset$metadata.sample2, collapse = NULL)
subset$Concatenated <- paste(subset$metadata.sample, subset$metadata.sample2, collapse = '')
subset$Concatenated <- paste(subset$metadata.sample, subset$metadata.sample2, sep = '')
metadata <- cbind(metadata,subset)
View(metadata)
names(metadata)[10] <- "samples"
alpha <- read.table("/home/mycelium/milkqua_project/Rumen/results/alpha_diversity/alpha.txt", header = TRUE)
View(alpha)
names(metadata)[10] <- "sample"
metadata <- fread("/home/mycelium/milkqua_project/Rumen/mapping_file_rumen.csv")
names(metadata)[1] <- "sample"
subset <- data.frame(metadata$sample)
subset <- subset %>%
mutate(metadata.sample2=metadata.sample)
library(tidyr)
subset$Concatenated <- paste(subset$metadata.sample, subset$metadata.sample2, sep = '')
metadata <- cbind(metadata,subset)
cols.dont.want <- "sample"
metadata <- cbind(metadata,subset)
cols.dont.want <- c("sample", "metadata.sample", "metadata.sample2")
metadata <- metadata[,! neames(metadata) %in% cols.dont.want, drop =F]
metadata <- metadata[,! names(metadata) %in% cols.dont.want, drop =F]
View(subset)
metadata %>% select(-1)
metadata <- fread("/home/mycelium/milkqua_project/Rumen/mapping_file_rumen.csv")
names(metadata)[1] <- "sample"
subset <- data.frame(metadata$sample)
subset <- subset %>%
mutate(metadata.sample2=metadata.sample)
library(tidyr)
subset$Concatenated <- paste(subset$metadata.sample, subset$metadata.sample2, sep = '')
metadata <- cbind(metadata,subset)
names(metadata)[2] <- "treatment"
names(metadata)[4] <- "timepoint"
View(metadata)
metadata <- cbind(metadata,subset)
metadata <- subset(metadata, select = -c("sample", "metadata.sample", "metadata.sample2")
View(metadata)
View(metadata)
View(metadata)
metadata <- fread("/home/mycelium/milkqua_project/Rumen/mapping_file_rumen.csv")
names(metadata)[1] <- "sample"
subset <- data.frame(metadata$sample)
subset <- subset %>%
mutate(metadata.sample2=metadata.sample)
library(tidyr)
subset$Concatenated <- paste(subset$metadata.sample, subset$metadata.sample2, sep = '')
names(metadata)[2] <- "treatment"
names(metadata)[4] <- "timepoint"
names(metadata)[10] <- "Samples"
alpha <- read.table("/home/mycelium/milkqua_project/Rumen/results/alpha_diversity/alpha.txt", header = TRUE)
alpha$sample <- row.names(alpha)
alpha$observed_species <- NULL
metadata <- fread("/home/mycelium/milkqua_project/Rumen/mapping_file_rumen.csv")
names(metadata)[1] <- "sample"
subset <- data.frame(metadata$sample)
subset <- subset %>%
mutate(metadata.sample2=metadata.sample)
library(tidyr)
subset$Concatenated <- paste(subset$metadata.sample, subset$metadata.sample2, sep = '')
names(metadata)[2] <- "treatment"
names(metadata)[4] <- "timepoint"
names(metadata)[10] <- "Samples"
metadata <- fread("/home/mycelium/milkqua_project/Rumen/mapping_file_rumen.csv")
names(metadata)[1] <- "sample"
subset <- data.frame(metadata$sample)
subset <- subset %>%
mutate(metadata.sample2=metadata.sample)
library(tidyr)
subset$Concatenated <- paste(subset$metadata.sample, subset$metadata.sample2, sep = '')
metadata <- cbind(metadata,subset)
names(metadata)[2] <- "treatment"
names(metadata)[4] <- "timepoint"
names(metadata)[10] <- "Samples"
alpha <- read.table("/home/mycelium/milkqua_project/Rumen/results/alpha_diversity/alpha.txt", header = TRUE)
alpha$sample <- row.names(alpha)
alpha$observed_species <- NULL
mAlpha <- reshape2::melt(alpha, id.vars = "sample", variable.name = "metric", value.name = "value")
mAlpha$type <- metadata$sample_type[match(mAlpha$sample,metadata$sample)]
mAlpha$timepoint <- metadata$timepoint[match(mAlpha$sample,metadata$sample)]
mAlpha$treatment <- metadata$treatment[match(mAlpha$sample,metadata$sample)]
mAlpha$timepoint <- factor(mAlpha$timepoint, levels = c("0","AE1","AE sintético 1","Carvacrol", "p-cymene", "γ-terpinene"))
D <- mAlpha %>%
group_by(metric,treatment, timepoint) %>%
summarize(N=n(),avg=round(mean(value),3)) %>%
spread(key = metric, value = avg)
D$timepoint <- factor(D$timepoint, levels = c("0","AE1","AE sintético 1","Carvacrol", "p-cymene", "γ-terpinene"))
d_alpha <- D %>%
gather(key = "metric", value = "value", -c(treatment,timepoint,N)) %>%
spread(key = "treatment", value = "value")
kable(D)
View(alpha)
View(mAlpha)
View(alpha)
View(subset)
metadata <- cbind(metadata,subset[3])
knitr::opts_chunk$set(echo = TRUE)
library("DT")
library("knitr")
library("dplyr")
library("tidyr")
library("broom")
library("vegan")
library("scales")
library("ggplot2")
library("ggpubr")
# library("madbito")
library("reshape2")
library("gghighlight")
library("data.table")
metadata <- fread("/home/mycelium/milkqua_project/Rumen/mapping_file_rumen.csv")
names(metadata)[1] <- "sample"
subset <- data.frame(metadata$sample)
subset <- subset %>%
mutate(metadata.sample2=metadata.sample)
subset$Concatenated <- paste(subset$metadata.sample, subset$metadata.sample2, sep = '')
metadata <- cbind(metadata,subset[3])
names(metadata)[2] <- "treatment"
names(metadata)[4] <- "timepoint"
names(metadata)[10] <- "Samples"
View(metadata)
metadata <- cbind(metadata[-1],subset[3])
names(metadata)[2] <- "treatment"
names(metadata)[4] <- "timepoint"
names(metadata)[8] <- "sample"
knitr::opts_chunk$set(echo = TRUE)
library("DT")
library("knitr")
library("dplyr")
library("tidyr")
library("broom")
library("vegan")
library("scales")
library("ggplot2")
library("ggpubr")
# library("madbito")
library("reshape2")
library("gghighlight")
library("data.table")
metadata <- fread("/home/mycelium/milkqua_project/Rumen/mapping_file_rumen.csv")
names(metadata)[1] <- "sample"
subset <- data.frame(metadata$sample)
subset <- subset %>%
mutate(metadata.sample2=metadata.sample)
subset$Concatenated <- paste(subset$metadata.sample, subset$metadata.sample2, sep = '')
metadata <- cbind(metadata[-1],subset[3])
View(metadata)
metadata <- fread("/home/mycelium/milkqua_project/Rumen/mapping_file_rumen.csv")
metadata <- fread("/home/mycelium/milkqua_project/Rumen/mapping_file_rumen.csv")
names(metadata)[1] <- "sample"
subset <- data.frame(metadata$sample)
subset <- subset %>%
mutate(metadata.sample2=metadata.sample)
subset$Concatenated <- paste(subset$metadata.sample, subset$metadata.sample2, sep = '')
metadata <- cbind(metadata[2:8],subset[3])
View(metadata)
metadata <- fread("/home/mycelium/milkqua_project/Rumen/mapping_file_rumen.csv")
names(metadata)[1] <- "sample"
subset <- data.frame(metadata$sample)
subset <- subset %>%
mutate(metadata.sample2=metadata.sample)
subset$Concatenated <- paste(subset$metadata.sample, subset$metadata.sample2, sep = '')
metadata <- cbind(metadata[2:8],subset[3])
